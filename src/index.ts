import { Telegraf, Markup } from "telegraf";
import dotenv from "dotenv";
dotenv.config();

const bot = new Telegraf(process.env.BOT_TOKEN!);

// –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏
const roleMenu = Markup.keyboard([
  ["üë®‚Äç‚öïÔ∏è –Ø –≤—Ä–∞—á", "üßç‚Äç‚ôÇÔ∏è –Ø –ø–∞—Ü–∏–µ–Ω—Ç"]
])
  .resize()
  .oneTime();

// –ú–µ–Ω—é —Ç–∏–ø–æ–≤ –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏–π
const poisoningMenu = Markup.keyboard([
  ["üíä –ê–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç—ã", "üíâ –ü—Å–∏—Ö–æ—Å—Ç–∏–º—É–ª—è—Ç–æ—Ä—ã"],
  ["üí§ –û–ø–∏–∞—Ç—ã", "üß† –ù–µ–π—Ä–æ–ª–µ–ø—Ç–∏–∫–∏ –∏ —Ç—Ä–∞–Ω–∫–≤–∏–ª–∏–∑–∞—Ç–æ—Ä—ã"],
  ["‚ò£Ô∏è –§–û–°, —è–¥—ã, —Ö–∏–º–∏–∫–∞—Ç—ã", "üçÑ –ì—Ä–∏–±—ã, –∞–ª–∫–æ–≥–æ–ª—å, —Ç–æ–∫—Å–∏–Ω—ã"],
  ["üî¨ MSL72Rph + –¢–ê–†–° / DWM"],
  ["‚¨ÖÔ∏è –ù–∞–∑–∞–¥"]
]).resize();

// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ –ø–æ–¥–º–µ–Ω—é (3 –∫–Ω–æ–ø–∫–∏)
const subMenu = (category: string, role: string) =>
  Markup.keyboard([
    ["‚öïÔ∏è –°–∏–º–ø—Ç–æ–º—ã", "üíä –¢–µ—Ä–∞–ø–∏—è", "üß© –ê–Ω—Ç–∏–¥–æ—Ç—ã"],
    ["‚¨ÖÔ∏è –ù–∞–∑–∞–¥"]
  ]).resize();

// –°–ª–æ–≤–∞—Ä—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å)
const data: Record<string, any> = {
  "üíä –ê–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç—ã": {
    doctor: {
      symptoms: `üß† **–ö–ª–∏–Ω–∏–∫–∞:** —Å—É—Ö–æ—Å—Ç—å —Å–ª–∏–∑–∏—Å—Ç—ã—Ö, —Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ QRS, —Å—É–¥–æ—Ä–æ–≥–∏, –∫–æ–º–∞. –í–æ–∑–º–æ–∂–µ–Ω "—Å–µ—Ä–æ—Ç–æ–Ω–∏–Ω–æ–≤—ã–π —Å–∏–Ω–¥—Ä–æ–º" –ø—Ä–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å –∞–Ω–∞–ª—å–≥–µ—Ç–∏–∫–∞–º–∏.`,
      therapy: `‚öïÔ∏è **–õ–µ—á–µ–Ω–∏–µ:** –ø—Ä–æ–º—ã–≤–∞–Ω–∏–µ –∂–µ–ª—É–¥–∫–∞, —Å–æ—Ä–±–µ–Ω—Ç—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å –≠–ö–ì, –ø—Ä–∏ —Å—É–¥–æ—Ä–æ–≥–∞—Ö ‚Äî –¥–∏–∞–∑–µ–ø–∞–º, –ø—Ä–∏ –∞—Ä–∏—Ç–º–∏—è—Ö ‚Äî –Ω–∞—Ç—Ä–∏—è –±–∏–∫–∞—Ä–±–æ–Ω–∞—Ç.`,
      antidotes: `üíâ **–ê–Ω—Ç–∏–¥–æ—Ç:** –≥–∞–ª–∞–Ω—Ç–∞–º–∏–Ω–∞ –≥–∏–¥—Ä–æ–±—Ä–æ–º–∏–¥ 0,5% ‚Äî 4‚Äì8 –º–ª –≤/–≤. –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ‚Äî –¥–∏–∞–∑–µ–ø–∞–º 20 –º–≥ –≤ 20 –º–ª 40% –≥–ª—é–∫–æ–∑—ã –≤/–≤.`
    },
    patient: {
      symptoms: `üß† –°—É—Ö–æ—Å—Ç—å –≤–æ —Ä—Ç—É, —É—á–∞—â—ë–Ω–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–µ, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∑—Ä–∞—á–∫–∏, —Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è.`,
      therapy: `üöë –°—Ä–æ—á–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–∫–æ—Ä—É—é! –ü—Ä–æ–º—ã—Ç—å –∂–µ–ª—É–¥–æ–∫ (–µ—Å–ª–∏ –≤ —Å–æ–∑–Ω–∞–Ω–∏–∏), –¥–∞—Ç—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É–≥–æ–ª—å.`,
      antidotes: `üíä –í –±–æ–ª—å–Ω–∏—Ü–µ –≤–≤–µ–¥—É—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã, —Å–Ω–∏–º–∞—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –∏ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É—é—â–∏–µ —Å–µ—Ä–¥—Ü–µ.`
    }
  },
  "üíâ –ü—Å–∏—Ö–æ—Å—Ç–∏–º—É–ª—è—Ç–æ—Ä—ã": {
    doctor: {
      symptoms: `‚ö° –í–æ–∑–±—É–∂–¥–µ–Ω–∏–µ, –≥–∏–ø–µ—Ä–≥–∏–¥—Ä–æ–∑, —Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è, –≥–∏–ø–µ—Ä—Ç–µ—Ä–º–∏—è, –≤–æ–∑–º–æ–∂–Ω–∞ —Ñ–∏–±—Ä–∏–ª–ª—è—Ü–∏—è –∂–µ–ª—É–¥–æ—á–∫–æ–≤.`,
      therapy: `üßä –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ, –¥–∏–∞–∑–µ–ø–∞–º –ø—Ä–∏ —Å—É–¥–æ—Ä–æ–≥–∞—Ö, –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Ç–º–∞, –ø—Ä–∏ –≥–∏–ø–µ—Ä—Ç–µ—Ä–º–∏–∏ ‚Äî —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ.`,
      antidotes: `‚ùå –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–¥–æ—Ç–∞ –Ω–µ—Ç. –°–∏–º–ø—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç–µ—Ä–∞–ø–∏—è.`
    },
    patient: {
      symptoms: `üòµ –ë–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ, –¥—Ä–æ–∂—å, –ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å, –±–æ–ª—å –≤ —Å–µ—Ä–¥—Ü–µ, –≤—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞.`,
      therapy: `üíß –û–±–∏–ª—å–Ω–æ–µ –ø–∏—Ç—å—ë, –ø–æ–∫–æ–π, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–∫–æ—Ä—É—é.`,
      antidotes: `‚ö†Ô∏è –õ–µ–∫–∞—Ä—Å—Ç–≤–∞ –æ—Ç –ø–µ—Ä–µ–¥–æ–∑–∏—Ä–æ–≤–∫–∏ –Ω–µ—Ç, –Ω—É–∂–Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –ø–æ–º–æ—â—å.`
    }
  },
  "üí§ –û–ø–∏–∞—Ç—ã": {
    doctor: {
      symptoms: `üò¥ –ö–æ–º–∞, –∞–ø–Ω–æ—ç, –º–∏–æ–∑, –≥–∏–ø–æ—Ç–µ–Ω–∑–∏—è, —Ä–∏—Å–∫ –∞—Å–ø–∏—Ä–∞—Ü–∏–∏.`,
      therapy: `üí® –û–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π, –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—è, –≤–≤–µ–¥–µ–Ω–∏–µ –Ω–∞–ª–æ–∫—Å–æ–Ω–∞.`,
      antidotes: `üíâ –ù–∞–ª–æ–∫—Å–æ–Ω 0,4‚Äì0,8 –º–≥, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 2‚Äì3 –º–∏–Ω.`
    },
    patient: {
      symptoms: `ü´• –ó–∞—Ç–æ—Ä–º–æ–∂–µ–Ω–Ω–æ—Å—Ç—å, —Ä–µ–¥–∫–æ–µ –¥—ã—Ö–∞–Ω–∏–µ, –º–∞–ª–µ–Ω—å–∫–∏–µ –∑—Ä–∞—á–∫–∏.`,
      therapy: `üöë –í—ã–∑–≤–∞—Ç—å —Å–∫–æ—Ä—É—é, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥—ã—Ö–∞–Ω–∏–µ, –Ω–µ –¥–∞–≤–∞—Ç—å —É—Å–Ω—É—Ç—å.`,
      antidotes: `üíâ –í –±–æ–ª—å–Ω–∏—Ü–µ –≤–≤–µ–¥—É—Ç –Ω–∞–ª–æ–∫—Å–æ–Ω ‚Äî –ø—Ä–µ–ø–∞—Ä–∞—Ç, —Å–Ω–∏–º–∞—é—â–∏–π –¥–µ–π—Å—Ç–≤–∏–µ –æ–ø–∏–∞—Ç–æ–≤.`
    }
  },
  "üß† –ù–µ–π—Ä–æ–ª–µ–ø—Ç–∏–∫–∏ –∏ —Ç—Ä–∞–Ω–∫–≤–∏–ª–∏–∑–∞—Ç–æ—Ä—ã": {
    doctor: {
      symptoms: `üß© –ê–Ω—Ç–∏—Ö–æ–ª–∏–Ω–µ—Ä–≥–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º, —ç–∫—Å—Ç—Ä–∞–ø–∏—Ä–∞–º–∏–¥–Ω—ã–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –≥–∏–ø–æ—Ç–µ–Ω–∑–∏—è.`,
      therapy: `üíâ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–∞–≤–ª–µ–Ω–∏—è, –ø—Ä–∏ —Å—É–¥–æ—Ä–æ–≥–∞—Ö ‚Äî –¥–∏–∞–∑–µ–ø–∞–º, –ø—Ä–∏ –≥–∏–ø–æ—Ç–æ–Ω–∏–∏ ‚Äî –¥–æ–ø–∞–º–∏–Ω.`,
      antidotes: `üíä –ì–∞–ª–∞–Ω—Ç–∞–º–∏–Ω 0,5% 4‚Äì8 –º–ª –≤/–≤.`
    },
    patient: {
      symptoms: `üò¥ –°–æ–Ω–ª–∏–≤–æ—Å—Ç—å, —Å–ª–∞–±–æ—Å—Ç—å, –Ω–µ—É—Å—Ç–æ–π—á–∏–≤–∞—è –ø–æ—Ö–æ–¥–∫–∞, –∑–∞—Ç–æ—Ä–º–æ–∂–µ–Ω–Ω–æ—Å—Ç—å.`,
      therapy: `üöë –°—Ä–æ—á–Ω–æ –≤ –±–æ–ª—å–Ω–∏—Ü—É, —É–ª–æ–∂–∏—Ç—å –Ω–∞ –±–æ–∫, –Ω–µ –¥–∞–≤–∞—Ç—å –∑–∞—Å–Ω—É—Ç—å.`,
      antidotes: `‚öïÔ∏è –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –≤–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤—Ä–∞—á–∞–º–∏.`
    }
  },
  "‚ò£Ô∏è –§–û–°, —è–¥—ã, —Ö–∏–º–∏–∫–∞—Ç—ã": {
    doctor: {
      symptoms: `üíÄ –ú–∏–æ–∑, –±—Ä–æ–Ω—Ö–æ—Ä–µ—è, —Å—É–¥–æ—Ä–æ–≥–∏, –≥–∏–ø–µ—Ä–≥–∏–¥—Ä–æ–∑.`,
      therapy: `‚ö° –ê—Ç—Ä–æ–ø–∏–Ω–∏–∑–∞—Ü–∏—è –¥–æ —Å—É—Ö–æ—Å—Ç–∏ —Å–ª–∏–∑–∏—Å—Ç—ã—Ö, –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –¥—ã—Ö–∞–Ω–∏—è.`,
      antidotes: `üíâ –ê—Ç—Ä–æ–ø–∏–Ω 0,1% –ø–æ 1 –º–ª –¥–æ –∫—É–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏–º–ø—Ç–æ–º–æ–≤, + –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∫–∞–ª–∏—è.`
    },
    patient: {
      symptoms: `ü§¢ –°–ª—é–Ω–æ—Ç–µ—á–µ–Ω–∏–µ, –ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å, —Å—É–¥–æ—Ä–æ–≥–∏.`,
      therapy: `üöë –í—ã–Ω–µ—Å—Ç–∏ –Ω–∞ —Å–≤–µ–∂–∏–π –≤–æ–∑–¥—É—Ö, –ø—Ä–æ–º—ã—Ç—å –∫–æ–∂—É –∏ –≥–ª–∞–∑–∞ –≤–æ–¥–æ–π.`,
      antidotes: `üíâ –í –±–æ–ª—å–Ω–∏—Ü–µ –≤–≤–µ–¥—É—Ç –∞—Ç—Ä–æ–ø–∏–Ω –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã.`
    }
  },
  "üçÑ –ì—Ä–∏–±—ã, –∞–ª–∫–æ–≥–æ–ª—å, —Ç–æ–∫—Å–∏–Ω—ã": {
    doctor: {
      symptoms: `üçÑ –†–≤–æ—Ç–∞, –ø–æ–Ω–æ—Å, –∂–µ–ª—Ç—É—Ö–∞, –ø–µ—á—ë–Ω–æ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å (–ø–æ–≥–∞–Ω–∫–∞), –≥–∏–ø–æ–≥–ª–∏–∫–µ–º–∏—è (—ç—Ç–∞–Ω–æ–ª).`,
      therapy: `üíß –ò–Ω—Ñ—É–∑–∏–∏, –≥–ª—é–∫–æ–∑–∞, –Ω–∞—Ç—Ä–∏—è —Ç–∏–æ—Å—É–ª—å—Ñ–∞—Ç, –ø—Ä–µ–¥–Ω–∏–∑–æ–ª–æ–Ω.`,
      antidotes: `üß™ –ü—Ä–∏ —ç—Ç–∞–Ω–æ–ª–µ ‚Äî –Ω–∞—Ç—Ä–∏—è —Ç–∏–æ—Å—É–ª—å—Ñ–∞—Ç, —É–Ω–∏—Ç–∏–æ–ª, —Ç–∏–∞–º–∏–Ω. –ü—Ä–∏ –º–µ—Ç–∞–Ω–æ–ª–µ ‚Äî —ç—Ç–∞–Ω–æ–ª 1 –º–ª/–∫–≥.`
    },
    patient: {
      symptoms: `ü§¢ –¢–æ—à–Ω–æ—Ç–∞, –±–æ–ª–∏ –≤ –∂–∏–≤–æ—Ç–µ, —Ä–≤–æ—Ç–∞, –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å.`,
      therapy: `üöë –°—Ä–æ—á–Ω–æ –≤—ã–∑–≤–∞—Ç—å —Å–∫–æ—Ä—É—é, –ø—Ä–æ–º—ã—Ç—å –∂–µ–ª—É–¥–æ–∫, –æ–±–∏–ª—å–Ω–æ–µ –ø–∏—Ç—å—ë.`,
      antidotes: `‚ö†Ô∏è –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∞–Ω—Ç–∏–¥–æ—Ç—ã –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å! –í—Å—ë —Ç–æ–ª—å–∫–æ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –≤—Ä–∞—á–∞.`
    }
  },
  "üî¨ MSL72Rph + –¢–ê–†–° / DWM": {
    doctor: {
      symptoms: `üåê –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤—Ä–∞—á–µ–π —Å–∫–æ—Ä–æ–π –ø–æ–º–æ—â–∏ –∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤. –ê–ª–≥–æ—Ä–∏—Ç–º—ã, –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫–∏.`,
      therapy: `üöÄ Digital World Medical ‚Äî –ø—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –≤ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –º–µ–¥–∏—Ü–∏–Ω–µ.`,
      antidotes: `ü§ñ –¢–ê–†–° –∏ MSL72Rph ‚Äî —è–¥—Ä–æ –æ–±—É—á–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.`
    },
    patient: {
      symptoms: `üåç –¶–∏—Ñ—Ä–æ–≤–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –ø—Ä–æ—Å–≤–µ—â–µ–Ω–∏—è.`,
      therapy: `üì≤ –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å —Å–∏–º–ø—Ç–æ–º—ã, –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–æ–≤—Ä–µ–º—è –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é.`,
      antidotes: `‚ù§Ô∏è –°–æ–∑–¥–∞–Ω–æ –≤—Ä–∞—á–∞–º–∏ –¥–ª—è –ª—é–¥–µ–π.`
    }
  }
};

let userRole: "doctor" | "patient" | null = null;

// === –õ–û–ì–ò–ö–ê ===
bot.start((ctx) => {
  ctx.reply(
    "üëã –ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –±–æ—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –ø–æ–º–æ—â–∏ –ø—Ä–∏ –æ—Å—Ç—Ä—ã—Ö –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è—Ö.\n–í—ã–±–µ—Ä–∏—Ç–µ, –∫—Ç–æ –≤—ã:",
    roleMenu
  );
});

bot.hears(["üë®‚Äç‚öïÔ∏è –Ø –≤—Ä–∞—á", "üßç‚Äç‚ôÇÔ∏è –Ø –ø–∞—Ü–∏–µ–Ω—Ç"], (ctx) => {
  userRole = ctx.message.text.includes("–≤—Ä–∞—á") ? "doctor" : "patient";
  ctx.reply(
    `–û—Ç–ª–∏—á–Ω–æ, ${userRole === "doctor" ? "–¥–æ–∫—Ç–æ—Ä" : "–¥—Ä—É–≥"}! –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è:`,
    poisoningMenu
  );
});

bot.hears(
  [
    "üíä –ê–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç—ã",
    "üíâ –ü—Å–∏—Ö–æ—Å—Ç–∏–º—É–ª—è—Ç–æ—Ä—ã",
    "üí§ –û–ø–∏–∞—Ç—ã",
    "üß† –ù–µ–π—Ä–æ–ª–µ–ø—Ç–∏–∫–∏ –∏ —Ç—Ä–∞–Ω–∫–≤–∏–ª–∏–∑–∞—Ç–æ—Ä—ã",
    "‚ò£Ô∏è –§–û–°, —è–¥—ã, —Ö–∏–º–∏–∫–∞—Ç—ã",
    "üçÑ –ì—Ä–∏–±—ã, –∞–ª–∫–æ–≥–æ–ª—å, —Ç–æ–∫—Å–∏–Ω—ã",
    "üî¨ MSL72Rph + –¢–ê–†–° / DWM"
  ],
  (ctx) => {
    const category = ctx.message.text;
    ctx.reply(`–í—ã –≤—ã–±—Ä–∞–ª–∏: ${category}. –ß—Ç–æ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?`, subMenu(category, userRole!));
    (ctx as any).session = { category };
  }
);

bot.hears(["‚öïÔ∏è –°–∏–º–ø—Ç–æ–º—ã", "üíä –¢–µ—Ä–∞–ø–∏—è", "üß© –ê–Ω—Ç–∏–¥–æ—Ç—ã"], (ctx) => {
  const choice = ctx.message.text;
  const session: any = (ctx as any).session;
  if (!session?.category || !userRole) return ctx.reply("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏—è.");
  const cat = data[session.category][userRole];

  const text =
    choice.includes("–°–∏–º–ø—Ç–æ–º—ã") ? cat.symptoms :
    choice.includes("–¢–µ—Ä–∞–ø–∏—è") ? cat.therapy :
    cat.antidotes;

  ctx.replyWithMarkdown(text);
});

bot.hears("‚¨ÖÔ∏è –ù–∞–∑–∞–¥", (ctx) => {
  if ((ctx as any).session?.category) {
    (ctx as any).session = null;
    ctx.reply("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:", poisoningMenu);
  } else {
    ctx.reply("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å:", roleMenu);
  }
});

bot.launch();
console.log("‚úÖ @drug_poisoning_bot –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ");
